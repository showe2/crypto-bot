{% extends "base.html" %} {% block title %}Token Analysis - Solana AI{% endblock
%} {% block content %}
<div x-data="analysisData()" x-init="initAnalysis()">
  <!-- Page Header -->
  <div class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">Token Analysis</h1>
        <p class="text-gray-600 mt-1">
          Comprehensive AI-powered cryptocurrency analysis
        </p>
      </div>
      <div class="flex items-center space-x-3">
        <button
          @click="clearResults()"
          x-show="hasResults"
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
        >
          <i class="fas fa-times mr-2"></i>
          Clear
        </button>
        <button
          @click="exportResults()"
          x-show="hasResults"
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
        >
          <i class="fas fa-download mr-2"></i>
          Export
        </button>
      </div>
    </div>
  </div>

  <!-- Analysis Form -->
  <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
    <h2 class="text-xl font-semibold text-gray-900 mb-6">Analyze Token</h2>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Token Input -->
      <div class="lg:col-span-2">
        <label class="form-label">Token Mint Address</label>
        <div class="relative">
          <input
            type="text"
            x-model="form.tokenMint"
            @keyup.enter="analyzeToken()"
            placeholder="Enter Solana token mint address (32-44 characters)..."
            class="form-input pr-12"
            :class="{ 'border-red-500': form.tokenMint && !isValidAddress }"
            :disabled="isAnalyzing"
          />

          <!-- Paste button -->
          <button
            @click="pasteFromClipboard()"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
            :disabled="isAnalyzing"
          >
            <i class="fas fa-clipboard"></i>
          </button>
        </div>

        <!-- Validation feedback -->
        <div
          x-show="form.tokenMint && !isValidAddress"
          class="mt-1 text-sm text-red-600"
        >
          <i class="fas fa-exclamation-circle mr-1"></i>
          Please enter a valid Solana token mint address
        </div>

        <!-- Quick Examples -->
        <div class="mt-3">
          <span class="text-sm text-gray-500">Examples:</span>
          <div class="flex flex-wrap gap-2 mt-1">
            {% for token in example_tokens %}
            <button
              @click="form.tokenMint = '{{ token.mint }}'"
              class="text-sm text-blue-600 hover:text-blue-800 underline"
              :disabled="isAnalyzing"
            >
              {{ token.name }} ({{ token.symbol }})
            </button>
            {% endfor %}
          </div>
        </div>
      </div>

      <!-- Analysis Options -->
      <div class="space-y-4">
        <div>
          <label class="form-label">Analysis Type</label>
          <select
            x-model="form.analysisType"
            class="form-input form-select"
            :disabled="isAnalyzing"
          >
            <option value="quick">Quick Analysis</option>
            <option value="deep">Deep Analysis (LLM)</option>
            <option value="both">Both (Comprehensive)</option>
          </select>
        </div>

        <div>
          <label class="form-label">Priority</label>
          <select
            x-model="form.priority"
            class="form-input form-select"
            :disabled="isAnalyzing"
          >
            <option value="normal">Normal</option>
            <option value="high">High Priority</option>
            <option value="low">Low Priority</option>
          </select>
        </div>

        <!-- Analysis Options -->
        <div class="space-y-2">
          <label class="flex items-center">
            <input
              type="checkbox"
              x-model="form.includeSocial"
              :disabled="isAnalyzing"
              class="mr-2"
            />
            <span class="text-sm">Include Social Analysis</span>
          </label>
          <label class="flex items-center">
            <input
              type="checkbox"
              x-model="form.includeOnChain"
              :disabled="isAnalyzing"
              class="mr-2"
            />
            <span class="text-sm">Include On-Chain Metrics</span>
          </label>
          <label class="flex items-center">
            <input
              type="checkbox"
              x-model="form.includeSecurity"
              :disabled="isAnalyzing"
              class="mr-2"
            />
            <span class="text-sm">Security Scan</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Analyze Button -->
    <div class="mt-6">
      <button
        @click="analyzeToken()"
        :disabled="!isValidAddress || isAnalyzing"
        class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium py-3 px-6 rounded-lg transition-colors"
      >
        <span x-show="!isAnalyzing" class="flex items-center justify-center">
          <i class="fas fa-search mr-2"></i>
          <span x-text="getAnalyzeButtonText()"></span>
        </span>
        <span x-show="isAnalyzing" class="flex items-center justify-center">
          <div class="loading-spinner mr-2"></div>
          <span x-text="analysisProgress.message"></span>
        </span>
      </button>

      <!-- Progress Bar -->
      <div x-show="isAnalyzing" class="mt-3">
        <div class="progress-bar">
          <div
            class="progress-bar-fill bg-blue-600"
            :style="`width: ${analysisProgress.percent}%`"
          ></div>
        </div>
        <div class="flex justify-between text-sm text-gray-600 mt-1">
          <span x-text="analysisProgress.step"></span>
          <span x-text="analysisProgress.percent + '%'"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Analysis Results -->
  <div x-show="hasResults" x-transition class="space-y-6">
    <!-- Token Overview -->
    <div x-show="results.metadata" class="bg-white rounded-xl shadow-lg p-6">
      <h3 class="text-xl font-semibold text-gray-900 mb-4">Token Overview</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Token Info -->
        <div class="text-center">
          <div
            class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <i class="fas fa-coins text-blue-600 text-2xl"></i>
          </div>
          <h4
            class="font-semibold text-gray-900"
            x-text="results.metadata?.name || 'Unknown Token'"
          ></h4>
          <p
            class="text-sm text-gray-500"
            x-text="results.metadata?.symbol || 'N/A'"
          ></p>
          <p
            class="text-xs text-gray-400 font-mono mt-1"
            x-text="truncateAddress(results.token)"
          ></p>
        </div>

        <!-- Price Data -->
        <div class="text-center" x-show="results.price_data">
          <div
            class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <i class="fas fa-dollar-sign text-green-600 text-2xl"></i>
          </div>
          <h4
            class="font-semibold text-gray-900"
            x-text="formatCurrency(results.price_data?.current_price)"
          ></h4>
          <p
            class="text-sm"
            :class="getPriceChangeClass(results.price_data?.price_change_24h)"
            x-text="formatPercent(results.price_data?.price_change_24h)"
          ></p>
          <p class="text-xs text-gray-400">24h Change</p>
        </div>

        <!-- Market Cap -->
        <div class="text-center" x-show="results.price_data?.market_cap">
          <div
            class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <i class="fas fa-chart-pie text-purple-600 text-2xl"></i>
          </div>
          <h4
            class="font-semibold text-gray-900"
            x-text="formatNumber(results.price_data?.market_cap)"
          ></h4>
          <p class="text-sm text-gray-500">Market Cap</p>
          <p
            class="text-xs text-gray-400"
            x-text="formatNumber(results.price_data?.volume_24h) + ' Vol'"
          ></p>
        </div>

        <!-- Holders -->
        <div class="text-center" x-show="results.price_data?.holders_count">
          <div
            class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3"
          >
            <i class="fas fa-users text-yellow-600 text-2xl"></i>
          </div>
          <h4
            class="font-semibold text-gray-900"
            x-text="formatNumber(results.price_data?.holders_count)"
          ></h4>
          <p class="text-sm text-gray-500">Holders</p>
          <p
            class="text-xs text-gray-400"
            x-text="formatNumber(results.onchain_metrics?.unique_traders_24h) + ' Traders'"
          ></p>
        </div>
      </div>
    </div>

    <!-- AI Analysis Results -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Quick Analysis -->
      <div
        x-show="results.quick_analysis"
        class="bg-white rounded-xl shadow-lg p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-900">Quick Analysis</h3>
          <div class="flex items-center space-x-2">
            <i class="fas fa-bolt text-yellow-500"></i>
            <span class="text-sm text-gray-500">Multi-Service</span>
          </div>
        </div>

        <template x-if="results.quick_analysis">
          <div class="space-y-4">
            <!-- Score -->
            <div class="text-center p-4 bg-gray-50 rounded-lg">
              <div
                class="text-3xl font-bold text-blue-600"
                x-text="Math.round(results.quick_analysis.score * 100)"
              ></div>
              <div class="text-sm text-gray-500">Overall Score</div>
              <div class="progress-bar mt-2">
                <div
                  class="progress-bar-fill bg-blue-600"
                  :style="`width: ${results.quick_analysis.score * 100}%`"
                ></div>
              </div>
            </div>

            <!-- Risk Level -->
            <div class="flex items-center justify-between">
              <span class="text-gray-700">Risk Level:</span>
              <span
                class="px-3 py-1 rounded-full text-sm font-medium"
                :class="getRiskLevelClass(results.quick_analysis.risk_level)"
                x-text="results.quick_analysis.risk_level?.toUpperCase()"
              ></span>
            </div>

            <!-- Recommendation -->
            <div class="flex items-center justify-between">
              <span class="text-gray-700">Recommendation:</span>
              <span
                class="px-3 py-1 rounded-full text-sm font-medium"
                :class="getRecommendationClass(results.quick_analysis.recommendation)"
                x-text="results.quick_analysis.recommendation"
              ></span>
            </div>

            <!-- Key Insights -->
            <div x-show="results.quick_analysis.key_insights?.length">
              <h4 class="font-medium text-gray-900 mb-2">Key Insights:</h4>
              <ul class="space-y-1">
                <template
                  x-for="insight in results.quick_analysis.key_insights"
                  :key="insight"
                >
                  <li class="text-sm text-gray-600 flex items-start">
                    <i
                      class="fas fa-chevron-right text-blue-500 mr-2 mt-0.5 text-xs"
                    ></i>
                    <span x-text="insight"></span>
                  </li>
                </template>
              </ul>
            </div>

            <!-- Processing Time -->
            <div class="text-xs text-gray-500 text-center">
              Processed in
              <span x-text="results.quick_analysis.processing_time"></span>s
            </div>
          </div>
        </template>
      </div>

      <!-- Deep Analysis -->
      <div
        x-show="results.deep_analysis"
        class="bg-white rounded-xl shadow-lg p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-900">Deep Analysis</h3>
          <div class="flex items-center space-x-2">
            <i class="fas fa-brain text-purple-500"></i>
            <span class="text-sm text-gray-500">LLM Enhanced</span>
          </div>
        </div>

        <template x-if="results.deep_analysis">
          <div class="space-y-4">
            <!-- Pump Probabilities -->
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center p-3 bg-gray-50 rounded-lg">
                <div
                  class="text-xl font-bold text-green-600"
                  x-text="Math.round(results.deep_analysis.pump_probability_1h * 100) + '%'"
                ></div>
                <div class="text-xs text-gray-500">1h Pump Probability</div>
              </div>
              <div class="text-center p-3 bg-gray-50 rounded-lg">
                <div
                  class="text-xl font-bold text-blue-600"
                  x-text="Math.round(results.deep_analysis.pump_probability_24h * 100) + '%'"
                ></div>
                <div class="text-xs text-gray-500">24h Pump Probability</div>
              </div>
            </div>

            <!-- Patterns -->
            <div x-show="results.deep_analysis.patterns?.length">
              <h4 class="font-medium text-gray-900 mb-2">Detected Patterns:</h4>
              <div class="flex flex-wrap gap-1">
                <template
                  x-for="pattern in results.deep_analysis.patterns"
                  :key="pattern"
                >
                  <span
                    class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"
                    x-text="pattern.replace('_', ' ')"
                  ></span>
                </template>
              </div>
            </div>

            <!-- Price Targets -->
            <div
              x-show="results.deep_analysis.price_targets && Object.keys(results.deep_analysis.price_targets).length"
            >
              <h4 class="font-medium text-gray-900 mb-2">Price Targets:</h4>
              <div class="space-y-1">
                <template
                  x-for="[timeframe, target] in Object.entries(results.deep_analysis.price_targets)"
                  :key="timeframe"
                >
                  <div class="flex justify-between text-sm">
                    <span class="text-gray-600" x-text="timeframe"></span>
                    <span
                      class="font-medium"
                      x-text="formatCurrency(target)"
                    ></span>
                  </div>
                </template>
              </div>
            </div>

            <!-- Key Insights -->
            <div x-show="results.deep_analysis.key_insights?.length">
              <h4 class="font-medium text-gray-900 mb-2">Key Insights:</h4>
              <ul class="space-y-1">
                <template
                  x-for="insight in results.deep_analysis.key_insights"
                  :key="insight"
                >
                  <li class="text-sm text-gray-600 flex items-start">
                    <i
                      class="fas fa-chevron-right text-purple-500 mr-2 mt-0.5 text-xs"
                    ></i>
                    <span x-text="insight"></span>
                  </li>
                </template>
              </ul>
            </div>

            <!-- Risk Factors -->
            <div x-show="results.deep_analysis.risk_factors?.length">
              <h4 class="font-medium text-gray-900 mb-2">Risk Factors:</h4>
              <ul class="space-y-1">
                <template
                  x-for="risk in results.deep_analysis.risk_factors"
                  :key="risk"
                >
                  <li class="text-sm text-red-600 flex items-start">
                    <i
                      class="fas fa-exclamation-triangle text-red-500 mr-2 mt-0.5 text-xs"
                    ></i>
                    <span x-text="risk"></span>
                  </li>
                </template>
              </ul>
            </div>

            <!-- Processing Time -->
            <div class="text-xs text-gray-500 text-center">
              Processed in
              <span x-text="results.deep_analysis.processing_time"></span>s
            </div>
          </div>
        </template>
      </div>
    </div>

    <!-- Analysis Metadata -->
    <div class="bg-gray-50 rounded-xl p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Analysis Details</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <div>
          <div class="text-sm text-gray-500">Analysis ID</div>
          <div class="font-mono text-sm" x-text="results.analysis_id"></div>
        </div>
        <div>
          <div class="text-sm text-gray-500">Processing Time</div>
          <div class="font-medium" x-text="results.processing_time + 's'"></div>
        </div>
        <div>
          <div class="text-sm text-gray-500">Data Sources</div>
          <div
            class="font-medium"
            x-text="results.sources_used?.join(', ') || 'N/A'"
          ></div>
        </div>
        <div>
          <div class="text-sm text-gray-500">Timestamp</div>
          <div class="font-medium" x-text="formatTime(results.timestamp)"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Results State -->
  <div x-show="!hasResults && !isAnalyzing" class="text-center py-12">
    <div
      class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"
    >
      <i class="fas fa-search text-gray-400 text-3xl"></i>
    </div>
    <h3 class="text-lg font-medium text-gray-900 mb-2">Ready to Analyze</h3>
    <p class="text-gray-600 mb-6">
      Enter a token mint address above to start comprehensive AI analysis
    </p>
    <div class="flex justify-center space-x-4">
      <button
        @click="loadExampleAnalysis()"
        class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
      >
        <i class="fas fa-play mr-2"></i>
        Try Example
      </button>
    </div>
  </div>
</div>

<script>
  function analysisData() {
    return {
      form: {
        tokenMint: '{{ selected_token or "" }}',
        analysisType: "quick",
        priority: "normal",
        includeSocial: true,
        includeOnChain: true,
        includeSecurity: true,
      },
      isAnalyzing: false,
      hasResults: false,
      results: null,
      analysisProgress: {
        step: "Initializing...",
        message: "Starting analysis...",
        percent: 0,
      },

      get isValidAddress() {
        return this.isValidSolanaAddress(this.form.tokenMint);
      },

      initAnalysis() {
        // Initialize with URL token if provided
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get("token");
        if (token) {
          this.form.tokenMint = token;
          // Auto-analyze if valid token in URL
          if (this.isValidAddress) {
            setTimeout(() => this.analyzeToken(), 1000);
          }
        }
      },

      getAnalyzeButtonText() {
        switch (this.form.analysisType) {
          case "quick":
            return "Quick Analysis (2-5s)";
          case "deep":
            return "Deep Analysis (8-15s)";
          case "both":
            return "Comprehensive Analysis (10-20s)";
          default:
            return "Analyze Token";
        }
      },

      async analyzeToken() {
        if (!this.isValidAddress) {
          this.$parent.showNotification(
            "error",
            "Invalid Address",
            "Please enter a valid Solana token mint address"
          );
          return;
        }

        this.isAnalyzing = true;
        this.hasResults = false;
        this.results = null;

        try {
          // Simulate analysis progress
          await this.simulateProgress();

          // Perform actual analysis using new endpoints
          let result;
          if (this.form.analysisType === "quick") {
            result = await this.callQuickAnalysis(this.form.tokenMint);
          } else if (this.form.analysisType === "deep") {
            result = await this.callDeepAnalysis(this.form.tokenMint);
          } else {
            // Both analyses
            const [quickResult, deepResult] = await Promise.all([
              this.callQuickAnalysis(this.form.tokenMint),
              this.callDeepAnalysis(this.form.tokenMint),
            ]);
            result = this.combineBothResults(quickResult, deepResult);
          }

          if (result.status === "success") {
            this.results = result;
            this.hasResults = true;

            this.$parent.showNotification(
              "success",
              "Analysis Complete",
              "Token analysis completed successfully"
            );
          } else {
            throw new Error(result.message || "Analysis failed");
          }
        } catch (error) {
          console.error("Analysis error:", error);
          this.$parent.showNotification(
            "error",
            "Analysis Failed",
            error.message || "Failed to analyze token"
          );
        } finally {
          this.isAnalyzing = false;
        }
      },

      async callQuickAnalysis(tokenMint) {
        const response = await fetch(`/quick/${tokenMint}`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || `HTTP ${response.status}`);
        }

        return await response.json();
      },

      async callDeepAnalysis(tokenMint) {
        const response = await fetch(`/deep/${tokenMint}`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || `HTTP ${response.status}`);
        }

        return await response.json();
      },

      combineBothResults(quickResult, deepResult) {
        return {
          ...deepResult,
          quick_analysis: quickResult.data?.quick_analysis,
          deep_analysis: deepResult.data?.deep_analysis,
          metadata: {
            name:
              deepResult.data?.token_info?.name ||
              quickResult.data?.token_info?.name,
            symbol:
              deepResult.data?.token_info?.symbol ||
              quickResult.data?.token_info?.symbol,
          },
          price_data:
            deepResult.data?.price_data || quickResult.data?.price_data,
          sources_used: [
            ...new Set([
              ...(quickResult.sources_used || []),
              ...(deepResult.sources_used || []),
            ]),
          ],
        };
      },

      async simulateProgress() {
        const steps = [
          { step: "Validating token address...", percent: 10 },
          { step: "Fetching token metadata...", percent: 25 },
          { step: "Collecting price data...", percent: 40 },
          { step: "Analyzing on-chain metrics...", percent: 60 },
          { step: "Running AI analysis...", percent: 80 },
          { step: "Generating insights...", percent: 95 },
          { step: "Finalizing results...", percent: 100 },
        ];

        for (const progressStep of steps) {
          this.analysisProgress = {
            ...progressStep,
            message: progressStep.step,
          };
          await new Promise((resolve) => setTimeout(resolve, 300));
        }
      },

      async pasteFromClipboard() {
        try {
          const text = await navigator.clipboard.readText();
          if (this.$parent.isValidSolanaAddress(text)) {
            this.form.tokenMint = text;
            this.$parent.showNotification(
              "success",
              "Pasted",
              "Token address pasted from clipboard"
            );
          } else {
            this.$parent.showNotification(
              "warning",
              "Invalid Format",
              "Clipboard content is not a valid Solana address"
            );
          }
        } catch (error) {
          this.$parent.showNotification(
            "error",
            "Paste Failed",
            "Failed to access clipboard"
          );
        }
      },

      clearResults() {
        this.hasResults = false;
        this.results = null;
        this.form.tokenMint = "";
      },

      exportResults() {
        if (!this.results) return;

        const data = {
          ...this.results,
          exported_at: new Date().toISOString(),
          export_format: "json",
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `token-analysis-${this.results.token.substring(0, 8)}-${
          new Date().toISOString().split("T")[0]
        }.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        this.$parent.showNotification(
          "success",
          "Export Complete",
          "Analysis results exported successfully"
        );
      },

      loadExampleAnalysis() {
        this.form.tokenMint = "So11111111111111111111111111111111111112"; // WSOL
        this.analyzeToken();
      },

      // Utility functions
      truncateAddress(address) {
        if (!address) return "N/A";
        return `${address.substring(0, 8)}...${address.substring(
          address.length - 8
        )}`;
      },

      formatCurrency(value) {
        if (!value) return "N/A";
        return `${parseFloat(value).toFixed(6)}`;
      },

      formatNumber(num) {
        if (!num && num !== 0) return "N/A";
        if (num >= 1e9) return (num / 1e9).toFixed(1) + "B";
        if (num >= 1e6) return (num / 1e6).toFixed(1) + "M";
        if (num >= 1e3) return (num / 1e3).toFixed(1) + "K";
        return Math.round(num).toString();
      },

      formatPercent(num) {
        if (!num && num !== 0) return "N/A";
        return `${num > 0 ? "+" : ""}${num.toFixed(1)}%`;
      },

      formatTime(timestamp) {
        if (!timestamp) return "Unknown";
        const date = new Date(timestamp);
        const now = new Date();
        const diff = now - date;

        if (diff < 60000) return "Just now";
        if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;
        if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`;
        return date.toLocaleDateString();
      },

      isValidSolanaAddress(address) {
        if (!address || typeof address !== "string") return false;
        if (address.length < 32 || address.length > 44) return false;
        return /^[1-9A-HJ-NP-Za-km-z]+$/.test(address);
      },

      getPriceChangeClass(change) {
        if (!change) return "text-gray-500";
        return parseFloat(change) >= 0 ? "text-green-600" : "text-red-600";
      },

      getRiskLevelClass(level) {
        const classes = {
          low: "bg-green-100 text-green-800",
          medium: "bg-yellow-100 text-yellow-800",
          high: "bg-red-100 text-red-800",
          critical: "bg-red-200 text-red-900",
        };
        return classes[level] || "bg-gray-100 text-gray-800";
      },

      getRecommendationClass(recommendation) {
        const classes = {
          BUY: "bg-green-100 text-green-800",
          CONSIDER: "bg-blue-100 text-blue-800",
          HOLD: "bg-yellow-100 text-yellow-800",
          CAUTION: "bg-orange-100 text-orange-800",
          AVOID: "bg-red-100 text-red-800",
        };
        return classes[recommendation] || "bg-gray-100 text-gray-800";
      },
    };
  }
</script>
{% endblock %}
