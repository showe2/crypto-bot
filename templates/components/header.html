<header
  class="fixed top-0 left-0 right-0 z-50 gradient-bg text-white shadow-lg"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Left Section -->
      <div class="flex items-center space-x-4">
        <!-- Mobile Menu Button -->
        <button
          @click="toggleSidebar()"
          class="lg:hidden p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors"
        >
          <i class="fas fa-bars text-xl"></i>
        </button>

        <!-- Logo and Title -->
        <div class="flex items-center space-x-3">
          <div class="relative">
            <div
              class="w-10 h-10 bg-white bg-opacity-20 rounded-lg flex items-center justify-center pulse-glow"
            >
              <i class="fas fa-robot text-xl"></i>
            </div>
            <!-- System Status Indicator -->
            <div
              class="absolute -top-1 -right-1 w-3 h-3 rounded-full border-2 border-white"
              :class="{
                                 'status-healthy': systemHealth && systemHealth.overall_status,
                                 'status-unhealthy': systemHealth && !systemHealth.overall_status,
                                 'status-warning': !systemHealth
                             }"
            ></div>
          </div>

          <div class="hidden sm:block">
            <h1 class="text-xl font-bold">Solana Token Analysis AI</h1>
            <p class="text-blue-100 text-sm">
              Advanced crypto intelligence platform
            </p>
          </div>
        </div>
      </div>

      <!-- Center Section - Quick Search -->
      <div class="hidden md:flex flex-1 max-w-md mx-8">
        <div
          class="relative w-full"
          x-data="{ searchQuery: '', searchResults: [] }"
        >
          <input
            type="text"
            x-model="searchQuery"
            @input="quickSearch($event.target.value)"
            placeholder="Quick search tokens (mint address)..."
            class="w-full px-4 py-2 pl-10 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg placeholder-blue-100 text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50"
          />
          <i
            class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-100"
          ></i>

          <!-- Quick Search Results -->
          <div
            x-show="searchResults.length > 0"
            class="absolute top-full left-0 right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 z-50 max-h-60 overflow-y-auto"
          >
            <template x-for="result in searchResults" :key="result.id">
              <div
                class="p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0"
                @click="selectToken(result)"
              >
                <div class="flex items-center justify-between">
                  <div>
                    <p
                      class="font-medium text-gray-900"
                      x-text="result.name || 'Unknown Token'"
                    ></p>
                    <p
                      class="text-sm text-gray-500"
                      x-text="result.symbol || 'N/A'"
                    ></p>
                    <p
                      class="text-xs text-gray-400 font-mono"
                      x-text="result.mint"
                    ></p>
                  </div>
                  <div class="text-right">
                    <p
                      class="text-sm font-medium text-gray-900"
                      x-text="formatNumber(result.price)"
                    ></p>
                    <p
                      class="text-xs"
                      :class="result.change >= 0 ? 'text-green-600' : 'text-red-600'"
                      x-text="formatPercent(result.change)"
                    ></p>
                  </div>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>

      <!-- Right Section -->
      <div class="flex items-center space-x-2">
        <!-- System Status Display -->
        <div
          class="hidden lg:flex items-center space-x-2 px-3 py-1 bg-white bg-opacity-20 rounded-lg"
        >
          <div
            class="w-2 h-2 rounded-full"
            :class="{
                             'status-healthy': systemHealth && systemHealth.overall_status,
                             'status-unhealthy': systemHealth && !systemHealth.overall_status,
                             'status-warning': !systemHealth
                         }"
          ></div>
          <span class="text-sm font-medium">
            <span x-show="systemHealth && systemHealth.overall_status"
              >System Online</span
            >
            <span x-show="systemHealth && !systemHealth.overall_status"
              >System Issues</span
            >
            <span x-show="!systemHealth">Checking...</span>
          </span>
        </div>

        <!-- Real-time Updates Toggle -->
        <button
          class="p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors"
          :class="{ 'bg-white bg-opacity-30': realtimeEnabled }"
          @click="toggleRealtime()"
          title="Toggle real-time updates"
        >
          <i class="fas fa-satellite-dish"></i>
        </button>

        <!-- Refresh Button -->
        <button
          @click="refreshData()"
          :disabled="isRefreshing"
          class="p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors disabled:opacity-50"
          title="Refresh system data"
        >
          <i
            class="fas fa-sync-alt"
            :class="{ 'animate-spin': isRefreshing }"
          ></i>
        </button>

        <!-- Notifications -->
        <div class="relative" x-data="{ showNotifications: false }">
          <button
            @click="showNotifications = !showNotifications"
            class="p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors relative"
            title="Notifications"
          >
            <i class="fas fa-bell"></i>
            <!-- Notification Badge -->
            <span
              x-show="notificationCount > 0"
              class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"
              x-text="notificationCount"
            ></span>
          </button>

          <!-- Notifications Dropdown -->
          <div
            x-show="showNotifications"
            @click.away="showNotifications = false"
            x-transition
            class="absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50"
          >
            <div class="p-4 border-b border-gray-200">
              <h3 class="font-semibold text-gray-900">Notifications</h3>
            </div>
            <div class="max-h-64 overflow-y-auto">
              <template
                x-for="notification in notifications"
                :key="notification.id"
              >
                <div class="p-3 border-b border-gray-100 hover:bg-gray-50">
                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0">
                      <i
                        :class="notification.icon"
                        class="text-sm"
                        :style="`color: ${notification.color}`"
                      ></i>
                    </div>
                    <div class="flex-1">
                      <p
                        class="text-sm font-medium text-gray-900"
                        x-text="notification.title"
                      ></p>
                      <p
                        class="text-xs text-gray-600"
                        x-text="notification.message"
                      ></p>
                      <p
                        class="text-xs text-gray-400 mt-1"
                        x-text="notification.time"
                      ></p>
                    </div>
                  </div>
                </div>
              </template>

              <div
                x-show="notifications.length === 0"
                class="p-6 text-center text-gray-500"
              >
                <i class="fas fa-bell-slash text-2xl mb-2"></i>
                <p>No notifications</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Settings -->
        <button
          @click="window.location.href = '/settings'"
          class="p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors"
          title="Settings"
        >
          <i class="fas fa-cog"></i>
        </button>

        <!-- Dark Mode Toggle -->
        <button
          @click="toggleDarkMode()"
          class="p-2 rounded-lg hover:bg-white hover:bg-opacity-20 transition-colors"
          title="Toggle dark mode"
        >
          <i :class="darkMode ? 'fas fa-sun' : 'fas fa-moon'"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Search Bar -->
  <div class="md:hidden px-4 pb-3">
    <div class="relative" x-data="{ mobileSearchQuery: '' }">
      <input
        type="text"
        x-model="mobileSearchQuery"
        placeholder="Search tokens..."
        class="w-full px-4 py-2 pl-10 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg placeholder-blue-100 text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50"
      />
      <i
        class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-blue-100"
      ></i>
    </div>
  </div>
</header>

<script>
  // Quick search functionality
  let searchTimeout;
  function quickSearch(query) {
    clearTimeout(searchTimeout);

    if (query.length < 3) {
      this.searchResults = [];
      return;
    }

    searchTimeout = setTimeout(async () => {
      try {
        // Mock search results for now
        this.searchResults = [
          {
            id: 1,
            name: "Wrapped SOL",
            symbol: "WSOL",
            mint: "So11111111111111111111111111111111111112",
            price: 23.45,
            change: 5.2,
          },
          {
            id: 2,
            name: "USD Coin",
            symbol: "USDC",
            mint: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",
            price: 1.0,
            change: 0.1,
          },
        ].filter(
          (token) =>
            token.name.toLowerCase().includes(query.toLowerCase()) ||
            token.symbol.toLowerCase().includes(query.toLowerCase()) ||
            token.mint.includes(query)
        );
      } catch (error) {
        console.error("Search failed:", error);
      }
    }, 300);
  }

  function selectToken(token) {
    // Navigate to token analysis page
    window.location.href = `/analysis?token=${token.mint}`;
  }
</script>
